{% extends "base.html" %}
{% block content %}

<h2 class="h4 mb-4 fw-bold">ğŸ¯ ê¸°ì—… ë§ì¶¤ í•©ê²© ë¶„ì„</h2>

<div class="card card-dark p-4 mb-5">
  <form method="post" class="row g-3 align-items-end">
    <div class="col-md-4">
      <label class="form-label text-secondary small">ì§€ì›í•  íšŒì‚¬</label>
      <select name="company" class="form-select bg-dark text-white border-secondary">
        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
        {% for c in company_options %}
          <option value="{{ c }}" {% if target_company == c %}selected{% endif %}>{{ c }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-6">
      <label class="form-label text-secondary small">ì§€ì› ì§ë¬´ (Position)</label>
      <input type="text" name="role" class="form-control bg-dark text-white border-secondary"
             placeholder="ì˜ˆ) ë°±ì—”ë“œ ê°œë°œì, ì„œë¹„ìŠ¤ ê¸°íš"
             value="{{ target_role or '' }}">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-ai w-100">ë¶„ì„ ì‹œì‘</button>
    </div>
  </form>
</div>

{% if error_msg %}
<div class="alert alert-danger bg-transparent border-danger text-danger">
  âš ï¸ {{ error_msg }}
</div>
{% endif %}

{% if ai_result %}
<div class="d-flex justify-content-end mb-2">
  <button class="btn btn-sm btn-outline-light" onclick="window.print()">ğŸ–¨ï¸ ê²°ê³¼ ì €ì¥ (PDF)</button>
</div>

<div class="card card-dark p-4 border-primary border-opacity-50">
  <div class="mb-4 pb-3 border-bottom border-secondary border-opacity-25">
    <h3 class="h5 mb-1 text-white">Analysis Report</h3>
    <p class="small text-secondary mb-0">
      <span class="text-info">{{ target_company }}</span> - 
      <span class="text-info">{{ target_role }}</span> ì§ë¬´ ê¸°ì¤€ ë¶„ì„ ê²°ê³¼
    </p>
  </div>
  
  <div class="markdown-body">
    {{ ai_result | safe }}
  </div>
</div>
{% endif %}

<div class="mt-5 pt-5 border-top border-secondary border-opacity-25">
  <h6 class="text-secondary small text-uppercase mb-3">Reference Data</h6>
  <div class="d-flex flex-wrap gap-2">
  {% for exp in experiences %}
    <span class="badge bg-dark border border-secondary text-secondary fw-normal">
      {{ exp.title }}
    </span>
  {% else %}
    <span class="text-secondary small">ë“±ë¡ëœ í™œë™ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</span>
  {% endfor %}
  </div>
</div>

{% endblock %}