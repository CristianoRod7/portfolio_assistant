{% extends "base.html" %}
{% block content %}

<h2 class="h4 mb-4 fw-bold">🎯 기업 맞춤 합격 분석</h2>

<!-- 입력 폼 영역 -->
<div class="card card-dark p-4 mb-5">
  <form method="post" class="row g-3 align-items-end">
    <div class="col-md-4">
      <label class="form-label text-secondary small">지원할 회사</label>
      <select name="company" class="form-select bg-dark text-white border-secondary">
        <option value="">선택하세요</option>
        {% for c in company_options %}
          <option value="{{ c }}" {% if target_company == c %}selected{% endif %}>{{ c }}</option>
        {% endfor %}
      </select>
    </div>
    
    <!-- 직무 선택 (수정됨) -->
    <div class="col-md-6">
      <label class="form-label text-secondary small">지원 직무 (Position)</label>
      <input type="text" name="role" list="roleOptions" 
             class="form-control bg-dark text-white border-secondary"
             placeholder="직무를 선택하거나 직접 입력하세요"
             value="{{ target_role or '' }}" autocomplete="off">
      
      <!-- 주요 IT 직무 리스트 -->
      <datalist id="roleOptions">
        <!-- 개발 직군 -->
        <option value="백엔드 개발자 (Backend Developer)">
        <option value="프론트엔드 개발자 (Frontend Developer)">
        <option value="풀스택 개발자 (Full Stack Developer)">
        <option value="모바일 앱 개발자 (Android/iOS)">
        <option value="데이터 엔지니어 (Data Engineer)">
        <option value="데이터 분석가 (Data Analyst)">
        <option value="인공지능/머신러닝 엔지니어 (AI/ML)">
        <option value="DevOps/SRE 엔지니어">
        <option value="보안 엔지니어 (Security)">
        <option value="임베디드 소프트웨어 개발자">
        <!-- 공기업/대기업 공통 -->
        <option value="SW 개발 / 전산직">
        <option value="ICT / 정보보호">
        <option value="IT 서비스 기획 (PM/PO)">
        <option value="R&D (연구개발)">
        <option value="시스템 엔지니어 (System Engineer)">
      </datalist>
    </div>

    <div class="col-md-2">
      <button type="submit" class="btn btn-ai w-100">분석 시작</button>
    </div>
  </form>
</div>

<!-- 결과 영역 -->
{% if ai_result %}
<div class="d-flex justify-content-end mb-2">
  <button class="btn btn-sm btn-outline-light" onclick="window.print()">🖨️ 결과 저장 (PDF)</button>
</div>

<div class="card card-dark p-4 border-primary border-opacity-50 mb-4">
  <div class="mb-4 pb-3 border-bottom border-secondary border-opacity-25">
    <h3 class="h5 mb-1 text-white">Analysis Report</h3>
    <p class="small text-secondary mb-0">
      <span class="text-info">{{ target_company }}</span> - 
      <span class="text-info">{{ target_role }}</span> 직무 기준 분석 결과
    </p>
  </div>
  
  <!-- 마크다운 렌더링 -->
  <div class="markdown-body">
    {{ ai_result | safe }}
  </div>
</div>

<!-- 면책 조항 -->
<div class="alert alert-warning bg-opacity-10 border-warning border-opacity-25 text-warning d-flex align-items-center" role="alert">
  <span class="fs-4 me-3">⚠️</span>
  <div class="small">
    <strong>AI 분석 결과는 참고용입니다.</strong><br>
    실제 채용 공고의 우대 사항이나 인재상은 수시로 변경될 수 있습니다.<br>
    지원 전 반드시 <a href="https://www.google.com/search?q={{ target_company }} 채용" target="_blank" class="alert-link">공식 채용 사이트</a>를 확인하시기 바랍니다.
  </div>
</div>

{% endif %}

{% endblock %}