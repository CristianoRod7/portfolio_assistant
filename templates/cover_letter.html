{% extends "base.html" %}
{% block content %}

<h2 class="h4 mb-4 fw-bold">✍️ 자기소개서 초안 작성</h2>

<div class="card card-dark p-4 mb-4">
  <form method="post" class="row g-3">
    <div class="col-md-6">
      <label class="form-label text-secondary small">지원 회사</label>
      <select name="company" class="form-select bg-dark text-white border-secondary">
        <option value="">선택하세요</option>
        {% for c in company_options %}
          <option value="{{ c }}" {% if target_company == c %}selected{% endif %}>{{ c }}</option>
        {% endfor %}
      </select>
    </div>
    
    <!-- 직무 선택 (추천 목록 적용) -->
    <div class="col-md-6">
      <label class="form-label text-secondary small">지원 직무</label>
      <input type="text" name="role" list="roleOptions"
             class="form-control bg-dark text-white border-secondary"
             value="{{ target_role or '' }}" 
             placeholder="직무를 선택하거나 입력하세요" autocomplete="off">

      <!-- 직무 추천 목록 (Datalist) -->
      <datalist id="roleOptions">
        <option value="백엔드 개발자 (Backend Developer)">
        <option value="프론트엔드 개발자 (Frontend Developer)">
        <option value="풀스택 개발자 (Full Stack Developer)">
        <option value="모바일 앱 개발자 (Android/iOS)">
        <option value="데이터 엔지니어 (Data Engineer)">
        <option value="데이터 분석가 (Data Analyst)">
        <option value="인공지능/머신러닝 엔지니어 (AI/ML)">
        <option value="DevOps/SRE 엔지니어">
        <option value="보안 엔지니어 (Security)">
        <option value="임베디드 소프트웨어 개발자">
        <option value="SW 개발 / 전산직">
        <option value="ICT / 정보보호">
        <option value="IT 서비스 기획 (PM/PO)">
        <option value="R&D (연구개발)">
        <option value="시스템 엔지니어 (System Engineer)">
      </datalist>
    </div>

    <div class="col-12">
      <label class="form-label text-secondary small">특별히 강조하고 싶은 점 (선택)</label>
      <input type="text" name="extra_request" class="form-control bg-dark text-white border-secondary"
             placeholder="예) 꼼꼼한 성격, 동아리 리더 경험 위주로 써줘">
    </div>
    <div class="col-12 text-end">
      <button type="submit" class="btn btn-ai px-4">AI 자소서 생성하기</button>
    </div>
  </form>
</div>

{% if letter_text %}
<div class="card card-dark p-4 p-lg-5 border-light border-opacity-10 mb-3">
  <div class="d-flex justify-content-between mb-4 border-bottom border-secondary border-opacity-25 pb-2">
    <h3 class="h5 text-white">Draft Preview</h3>
    <button class="btn btn-sm btn-outline-secondary" onclick="window.print()">Save PDF</button>
  </div>
  
  <!-- 마크다운 결과 표시 -->
  <div class="markdown-body" style="line-height: 1.8;">
    {{ letter_text | safe }}
  </div>
</div>

<!-- 주의 문구 (Disclaimer) -->
<div class="alert alert-danger bg-opacity-10 border-danger border-opacity-25 text-danger small">
  <strong>🛑 주의:</strong> 이 내용은 AI가 작성한 초안(Draft)입니다. <br>
  그대로 제출하지 마시고, <strong>본인의 경험과 말투에 맞게 반드시 다듬어서</strong> 사용하세요.
</div>
{% endif %}

{% endblock %}