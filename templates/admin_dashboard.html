{% extends "base.html" %}
{% block content %}

<div class="card card-dark p-4 mb-4">
  <h4 class="fw-bold text-white mb-3">
    ğŸ›  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
  </h4>
  <p class="text-secondary small mb-4">
    ì „ì²´ ìœ ì €ì™€ í¬íŠ¸í´ë¦¬ì˜¤ í™œë™ í˜„í™©ì„ í•œëˆˆì— ë³´ëŠ” ê´€ë¦¬ì ì „ìš© í˜ì´ì§€ì…ë‹ˆë‹¤.
  </p>

  <!-- ìƒë‹¨ ìš”ì•½ ì¹´ë“œ 3ê°œ -->
  <div class="row g-3 mb-4">
    <div class="col-md-4">
      <div class="card card-dark p-3 h-100">
        <p class="text-secondary small mb-1">ì „ì²´ ìœ ì € ìˆ˜</p>
        <h3 class="fw-bold text-white mb-0">{{ total_users }}</h3>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card card-dark p-3 h-100">
        <p class="text-secondary small mb-1">ì „ì²´ í™œë™ ìˆ˜</p>
        <h3 class="fw-bold text-white mb-0">{{ total_experiences }}</h3>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card card-dark p-3 h-100">
        <p class="text-secondary small mb-1">í™œë™ì´ ìˆëŠ” ìœ ì € ìˆ˜</p>
        <h3 class="fw-bold text-white mb-0">{{ active_users }}</h3>
      </div>
    </div>
  </div>

  <!-- ì „ê³µ ë¶„í¬ -->
  <div class="card card-dark p-3 mb-4">
    <h5 class="fw-bold text-white mb-2">ğŸ“ ì „ê³µë³„ ìœ ì € ë¶„í¬ (Top 5)</h5>
    {% if majors %}
      <div class="table-responsive">
        <table class="table table-dark table-sm align-middle mb-0">
          <thead class="table-secondary text-dark">
            <tr>
              <th>ì „ê³µ</th>
              <th style="width:120px;">ìœ ì € ìˆ˜</th>
            </tr>
          </thead>
          <tbody>
            {% for m in majors %}
            <tr>
              <td>{{ m.major }}</td>
              <td>{{ m.cnt }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-secondary small mb-0">í”„ë¡œí•„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </div>

  <!-- ì•„ë˜ 2ì—´: ìµœê·¼ ê°€ì… / í™œë™ ë§ì´ í•œ ìœ ì € -->
  <div class="row g-4">
    <div class="col-md-6">
      <div class="card card-dark p-3 h-100">
        <h5 class="fw-bold text-white mb-2">ğŸ•’ ìµœê·¼ ê°€ì… ìœ ì €</h5>
        {% if recent_users %}
          <div class="table-responsive">
            <table class="table table-dark table-sm align-middle mb-0">
              <thead class="table-secondary text-dark">
                <tr>
                  <th style="width:60px;">ID</th>
                  <th>ì´ë©”ì¼</th>
                  <th style="width:140px;">ê°€ì…ì¼</th>
                </tr>
              </thead>
              <tbody>
                {% for u in recent_users %}
                <tr>
                  <td>{{ u.id }}</td>
                  <td>{{ u.email }}</td>
                  <td>{{ u.created_at }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-secondary small mb-0">ê°€ì…ëœ ìœ ì €ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
      </div>
    </div>

    <div class="col-md-6">
      <div class="card card-dark p-3 h-100">
        <h5 class="fw-bold text-white mb-2">ğŸ”¥ í™œë™ ë§ì€ ìœ ì €</h5>
        {% if top_users %}
          <div class="table-responsive">
            <table class="table table-dark table-sm align-middle mb-0">
              <thead class="table-secondary text-dark">
                <tr>
                  <th style="width:60px;">ID</th>
                  <th>ì´ë©”ì¼</th>
                  <th style="width:120px;">í™œë™ ìˆ˜</th>
                  <th style="width:120px;">ê´€ë¦¬</th>
                </tr>
              </thead>
              <tbody>
                {% for u in top_users %}
                <tr>
                  <td>{{ u.id }}</td>
                  <td>{{ u.email }}</td>
                  <td>{{ u.exp_count }}</td>
                  <td>
                    <a href="{{ url_for('admin_user_profile', user_id=u.id) }}" class="btn btn-sm btn-outline-light">
                      ë³´ê¸°
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-secondary small mb-0">í™œë™ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
      </div>
    </div>
  </div>

</div>

<div class="text-center mt-3 d-flex justify-content-center gap-3">
  <a href="{{ url_for('admin_user_list') }}" class="btn btn-outline-light">
    ğŸ‘¥ ìœ ì € ëª©ë¡
  </a>
  <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
    â† ë©”ì¸ìœ¼ë¡œ
  </a>
</div>

{% endblock %}
